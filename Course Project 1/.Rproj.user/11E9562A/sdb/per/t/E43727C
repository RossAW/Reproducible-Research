{
    "contents" : "---\ntitle: \"Reproducible Research: Peer Assessment 1\"\noutput: \n  html_document:\n    keep_md: true\n---\nThis report summarises the activity data collected from an anonymous individual over the course of two months.\n\n## Loading and preprocessing the data\n```{r}\nRawData<- read.csv(\"activity.csv\",header = TRUE)\n\n```\nThe date data is of the \"factor\" class. To make things a bit easier I am going to change the class to \"Date\".\n\n```{r}\nRawData$date<-as.Date(RawData$date)\n\n```\n\n\n## What is mean total number of steps taken per day?  \nTo answer this I used the \"group_by()\" and \"summarise_each()\" functions to create a data frame with the sum of the steps by date.\nI then used the ggplot2 system to create a histogram of the data.\n\n```{r}\nlibrary(ggplot2)\nlibrary(dplyr)\n\nDailyStepTotal<-summarise_each(group_by(RawData,date),funs(sum(steps,na.rm = TRUE)))\n\nHistStepsPerDay<-ggplot(data = DailyStepTotal, aes(steps)) + geom_histogram()+\n    ggtitle(\"Total Steps Taken\")\n    \n\nprint(HistStepsPerDay)\n```\n\nLooks like the most frequent amount of steps taken was in the 10,000 and 0 regions. It looks like the NAs in the data are being treated as 0 when plotting. Lets have a look at the mean and median.\n\n```{r}\nmean(DailyStepTotal$steps)\nmedian(DailyStepTotal$steps)\n\n```\n\n## What is the average daily activity pattern?\n\nTo answer this I created a data frame with the mean steps per interval and plotted it.\n```{r}\nMeanStepsPerInterval<-summarise_each(group_by(RawData,interval),funs(mean(steps,na.rm = TRUE)))\n\nplotMeanIntervalPattern<-ggplot(data = MeanStepsPerInterval, aes(interval,steps)) +\n    geom_line()+\n    ggtitle(\"Average Daily Activity Pattern\")\n    \n\nprint(plotMeanIntervalPattern)\n```\n\nLooks like the subject does some jogging in the morning and is then walking fairly consitently throughout the day.\nWhich interval has the most activity?  \n```{r}\nMostActiveInterval<-MeanStepsPerInterval[MeanStepsPerInterval$steps==max(MeanStepsPerInterval$steps),1]\nMostActiveInterval\n```\nThe most active interval was `r MostActiveInterval`. At ~200 steps in 5min it means the subject goes for a jog in the morning or he realises that he is running late for work most mornings.\n\n## Imputing missing values\nHow many NAs are in the data set?\n```{r}\nsum(is.na(RawData$steps)) \n```\n\nI decided to fill in the NAs with the values from the mean activity curve worked out previously.\n```{r}\n\nRawDataMinusNAs<-RawData\nNALocations<-is.na(RawData$steps)\n\nRawDataMinusNAs$steps<-replace(RawData$steps,NALocations,MeanStepsPerInterval$steps)\n\nModifiedDailyStepTotal<-summarise_each(group_by(RawDataMinusNAs,date),funs(sum(steps,na.rm = TRUE)))\n\nModifiedHistStepsPerDay<-ggplot(data = ModifiedDailyStepTotal, aes(steps)) + geom_histogram()+\n    ggtitle(\"Total Steps Taken with NAs substituted for the mean\")\n    \n\nprint(ModifiedHistStepsPerDay)\n\n```\n\nRemoving the NAs and replacing them with the mean value for that interval significantly decreased the 0 step peak. Lets have another look at the mean and median.\n\n```{r}\nmean(ModifiedDailyStepTotal$steps)\nmedian(ModifiedDailyStepTotal$steps)\n\n```\n\nA median of 10,000 steps a is fairly impressive, the subject must have a job that involves walking as well as jogging on a regular basis.\n\n## Are there differences in activity patterns between weekdays and weekends?\n\nLets have a quick look at the patterns across each day.\n\n```{r}\n\nRawDataMinusNAs$Weekday<-weekdays(RawDataMinusNAs$date)\n\nggplot(RawDataMinusNAs,aes(interval,steps))+geom_line(color=\"aquamarine4\")+facet_wrap(~Weekday, ncol = 1)+ggtitle(\"Activity Pattern per Weekday\")\n```\n\nThere isn't as much early morning activity on Saturday, Sunday and Thursday. Lets combine the data into Weekday and Weekend categories.\n\n```{r}\n\n#If you know a better way of doing this please let me know.\nWeekdayData<-RawDataMinusNAs[RawDataMinusNAs$Weekday==\"Monday\" |\n                                 RawDataMinusNAs$Weekday==\"Tuesday\" |\n                                 RawDataMinusNAs$Weekday==\"Wednesday\" |\n                                 RawDataMinusNAs$Weekday==\"Thursday\" |\n                                 RawDataMinusNAs$Weekday==\"Friday\",]\n\nWeekendData<-RawDataMinusNAs[RawDataMinusNAs$Weekday==\"Sunday\" |\n                                 RawDataMinusNAs$Weekday==\"Saturday\",]\n\nMeanWeekdayData<-summarise_each(group_by(WeekdayData,interval),funs(mean(steps)))\n\nMeanWeekendData<-summarise_each(group_by(WeekendData,interval),funs(mean(steps)))\n\nMeanWeekendData$Weekday<-\"Weekend\"\nMeanWeekdayData$Weekday<-\"Weekday\"\n\nMeanDayComparisonData<-rbind(MeanWeekendData,MeanWeekdayData)\n\n\np4<-ggplot(MeanDayComparisonData,aes(interval,steps))+\n    geom_line()+\n    facet_grid(Weekday ~.)+\n    ggtitle(\"Weekday vs Weekend Activity Comparison\")\np4\n```\n\nThe main difference difference seems to be that their is more early morning activity on Weekdays and more late activity on Weekends. Lets overlap the plots and have another look.\n\n```{r}\n\nWeekdayComparisionPlot<-ggplot(MeanDayComparisonData,aes(interval,steps,color=Weekday))+geom_line()+\n    ggtitle(\"Weekday vs Weekend Activity Comparison\")\nWeekdayComparisionPlot\n\n```\n\n\n```{r}\nTotalStepsByWeekday<-summarise_each(group_by(MeanDayComparisonData,Weekday),funs(sum(steps)))\n\nTotalStepsByWeekday[,c(1,3)]\n```\n\nOverall the subject is more active on the weekend then he is during the week.\n\n\n\n",
    "created" : 1442049502191.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2334201109",
    "id" : "E43727C",
    "lastKnownWriteTime" : 1442201434,
    "path" : "C:/Users/Ross Weston/GitHub Repos/Reproducible Research/Course Project 1/PA1_template.Rmd",
    "project_path" : "PA1_template.Rmd",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_markdown"
}